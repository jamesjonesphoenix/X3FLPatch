<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet href="director.xsl" type="text/xsl" ?>
<director name="template" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="director.xsd">
  <documentation>
    <author name="Owen Lake" alias="Xenon_Slayer" contact="E-Mail: Owen@egosoft.com Skype: Owen Lake" />
    <content reference="L2M009" name="Tutorials" description="Basic tutorial for the starting player"/>
    <version number="1.2" date="16/09/2008" status="release"/>
  </documentation>
  <cues>
    <cue name="L2M009" delay="5s" version="3" check="cancel">
      <documentation>
        <content name="Tutorial" reference="L2M009" type="L2"/>
        <version date="16/09/2008" number="1.2" status="release"/>
        <history>
          <change author="Owen Lake" date="16/09/2008" description="Version:2 - Version for TC 1.2. Fixed several bugs."/>
          <change author="Owen Lake" date="05/09/2008" description="Version for TC 1.0.1."/>
          <change author="Al Main" date="05/08/2008" description="Heavy modifications"/>
          <change author="Owen Lake" date="11/07/2008" description="Initial Version"/>
          <change author="Ketraar" date="13/08/2016" description="Added gamestart check so it will only start in the Flight School Start."/>
        </history>
      </documentation>
      <condition>
        <check_all>
          <check_value value="{player.gamestart}" exact="101" />
        </check_all>
      </condition>
      <action>
        <do_all>
          <set_value name="L2M009.OfferRace" exact="{player.sector.race}"/>
          <do_choose>
            <do_when value="{value@L2M009.OfferRace}" exact="{lookup.race@argon}">
              <set_value name="L2M009.TutorialShipType" exact="{random.type@SS_SH_A_M3|SS_SH_A_M4}"/>
              <create_actor name="L2M009.OfferActor" race="{value@L2M009.OfferRace}" gender="male" voice="110"/>
            </do_when>
            <do_when value="{value@L2M009.OfferRace}" exact="{lookup.race@boron}">
              <set_value name="L2M009.TutorialShipType" exact="{random.type@SS_SH_B_M3|SS_SH_B_M4}"/>
              <create_actor name="L2M009.OfferActor" race="{value@L2M009.OfferRace}" voice="210"/>
            </do_when>
            <do_when value="{value@L2M009.OfferRace}" exact="{lookup.race@paranid}">
              <set_value name="L2M009.TutorialShipType" exact="{random.type@SS_SH_P_M3|SS_SH_P_M4}"/>
              <create_actor name="L2M009.OfferActor" race="{value@L2M009.OfferRace}" voice="410"/>
            </do_when>
            <do_when value="{value@L2M009.OfferRace}" exact="{lookup.race@split}">
              <set_value name="L2M009.TutorialShipType" exact="{random.type@SS_SH_S_M3|SS_SH_S_M4}"/>
              <create_actor name="L2M009.OfferActor" race="{value@L2M009.OfferRace}" voice="310"/>
            </do_when>
            <do_when value="{value@L2M009.OfferRace}" exact="{lookup.race@teladi}">
              <set_value name="L2M009.TutorialShipType" exact="{random.type@SS_SH_T_M3|SS_SH_T_M4}"/>
              <create_actor name="L2M009.OfferActor" race="{value@L2M009.OfferRace}" voice="510"/>
            </do_when>
            <do_when value="{value@L2M009.OfferRace}" exact="{lookup.race@terran}">
              <set_value name="L2M009.TutorialShipType" exact="{lookup.type@SS_SH_USC_M4}"/>
              <create_actor name="L2M009.OfferActor" race="{value@L2M009.OfferRace}" gender="male" voice="110"/>
            </do_when>
            <do_when value="{value@L2M009.OfferRace}" exact="{lookup.race@yaki}">
              <set_value name="L2M009.TutorialShipType" exact="{lookup.type@SS_SH_Y_M4}"/>
              <create_actor name="L2M009.OfferActor" race="{value@L2M009.OfferRace}" gender="male" voice="110" subrace="argon"/>
            </do_when>
            <do_otherwise>
              <cancel_cue cue="L2M009"/>
            </do_otherwise>
          </do_choose>
          <create_ship name="TutorialShip" race="{value@L2M009.OfferRace}" typename="{value@L2M009.TutorialShipType}" capturable="0" invincible="1" safety="0">
            <position object="{player.ship}" x="500m" y="500m" z="2km"/>
            <equipment loadout="default">
              <ware typename="SS_WARE_WARPING" exact="1" critical="1"/>
            </equipment>
            <cargo>
              <ware typename="SS_WARE_ENERGY" exact="100" critical="1"/>
            </cargo>
            <!--we want him to fly infront of the player's starting position incase the player doesnt notice him-->
            <command command="movecontinue" distance="400m">
              <position x="0" y="0" z="1km"/>
            </command>
            <pilot jobtextid="20010"/>
          </create_ship>
          <set_safety object="TutorialShip" safety="0"/>
          <set_actor_location actor="L2M009.OfferActor" object="TutorialShip" location="pilot"/>
          <set_override_name_flags object="TutorialShip" race="1" job="1" type="1" variation="1"/>

          <find_object name="L2M009.InactiveGate1" typename="SS_SPECIAL_INVMARKER" nearest="1">
            <position x="-15km" y="0km" z="-8km" max="1km"/>
            <sector sector="{player.sector}"/>
          </find_object>
          <find_object name="L2M009.InactiveGate2" typename="SS_SPECIAL_INVMARKER" nearest="1">
            <position x="-28km" y="0km" z="-9km" max="1km"/>
            <sector sector="{player.sector}"/>
          </find_object>
          <find_object name="L2M009.InactiveGate3" typename="SS_SPECIAL_INVMARKER" nearest="1">
            <position x="-35km" y="0km" z="-3km" max="1km"/>
            <sector sector="{player.sector}"/>
          </find_object>
          <find_object name="L2M009.InactiveGate4" typename="SS_SPECIAL_INVMARKER" nearest="1">
            <position x="-36km" y="11km" z="5km" max="1km"/>
            <sector sector="{player.sector}"/>
          </find_object>
          <find_object name="L2M009.InactiveGate5" typename="SS_SPECIAL_INVMARKER" nearest="1">
            <position x="-24km" y="21km" z="16km" max="1km"/>
            <sector sector="{player.sector}"/>
          </find_object>
          <find_object name="L2M009.InactiveGate6" typename="SS_SPECIAL_INVMARKER" nearest="1">
            <position x="-10km" y="13km" z="17km" max="1km"/>
            <sector sector="{player.sector}"/>
          </find_object>
          <find_object name="L2M009.Spawnpoint" typename="SS_SPECIAL_INVMARKER" nearest="1">
            <position x="-2km" y="-22km" z="-37km" max="1km"/>
            <sector sector="{player.sector}"/>
          </find_object>
          <find_station name="L2M009.Outpost" typename="SS_DOCK_A_MILITARY">
            <sector sector="{player.sector}"/>
          </find_station>
          <set_invincible object="L2M009.Outpost" invincible="1"/>
          <set_value name="L2M009.TutorialStage" exact="0"/>
        </do_all>
      </action>
      <cues>
        <cue name="L2M009 Start Tutorial" version="3">
          <timing>
            <time exact="2s"/>
          </timing>
          <action>
            <do_all>
              <do_choose>
                <do_when value="{actor.ship.exists@L2M009.OfferActor}" exact="1">
                  <create_offer actor="L2M009.OfferActor" conversation="L2M009 No1" discipline="XXXT"/>
                  <do_if value="{player.target.exists}" exact="0">
                    <set_target object="TutorialShip"/>
                  </do_if>
                  <do_if value="{player.target}" exact="{object@TutorialShip}">
                    <show_help force="1" text="{2600,16}"/>
                  </do_if>
                </do_when>
                <do_otherwise>
                  <!--if ship has been destroyed then dont create more as the starting sectors are relatively 'safe'
                    (and we dont want flight school ships created later when the player can clearly play?)-->
                  <cancel_cue cue="L2M009"/>
                </do_otherwise>
              </do_choose>
            </do_all>
          </action>
          <cues>
            <cue name="L2M009 Attacked Instructor Before" delay="1s">
              <condition>
                <object_relation object="TutorialShip">
                  <relation relation="enemy"/>
                </object_relation>
              </condition>
              <action>
                <do_all>
                  <set_highlight object="TutorialShip" highlight="0"/>
                  <remove_offer actor="L2M009.OfferActor" conversation="L2M009 No1" discipline="XXXT"/>
                </do_all>
              </action>
              <cues>
                <cue name="L2M009 Player Changed Sector 2" version="2">
                  <condition>
                    <object_changed_sector/>
                  </condition>
                  <action>
                    <do_all>
                      <set_relation object="TutorialShip">
                        <relation relation="friend"/>
                      </set_relation>
                      <set_command object="TutorialShip" command="idle"/>
                      <reset_cue cue="L2M009 Start Tutorial"/>
                    </do_all>
                  </action>
                </cue>
              </cues>
            </cue>
            <cue name="L2M009 Accepted">
              <condition>
                <conversation_completed actor="L2M009.OfferActor" conversation="L2M009 No1" answer="ready"/>
              </condition>
              <action>
                <do_all>
                  <remove_offer actor="L2M009.OfferActor" discipline="XXXT" conversation="L2M009 No1"/>
                  <create_offer actor="L2M009.OfferActor" conversation="L2M009 Quit"/>
                  <set_highlight object="TutorialShip" highlight="1"/>
                  <set_command object="TutorialShip" command="stay"/>
                  <cancel_cue cue="L2M009 Instructor Orders"/>
                  <cancel_cue cue="L2M009 Attacked Instructor Before"/>
                </do_all>
              </action>
              <cues>
                <cue name="L2M009 Left Sector" version="2">
                  <condition>
                    <object_changed_sector/>
                  </condition>
                  <action>
                    <do_choose>
                      <do_when value="{player.sector}" exact="{actor.sector@L2M009.OfferActor}">
                        <reset_cue cue="L2M009 Left Sector"/>
                      </do_when>
                      <do_otherwise>
                        <set_highlight object="TutorialShip" highlight="0"/>
                        <remove_offer actor="L2M009.OfferActor" conversation="L2M009 Quit"/>
                        <remove_objective cue="L2M009"/>
                        <do_if value="{object.exists@L2M009.Station}" exact="1">
                          <set_highlight object="L2M009.Station" highlight="0"/>
                        </do_if>
                        <incoming_message author="{actor.name@L2M009.OfferActor}" text="{110,848} {{actor.voice@L2M009.OfferActor},951}"/>
                        <set_command object="TutorialShip" command="idle"/>
                        <reset_cue cue="L2M009 Start Tutorial"/>
                      </do_otherwise>
                    </do_choose>
                  </action>
                </cue>
                <cue name="L2M009 Quit" version="2">
                  <condition>
                    <conversation_completed actor="L2M009.OfferActor" conversation="L2M009 Quit" answer="cancel"/>
                  </condition>
                  <action>
                    <do_all>
                      <set_highlight object="TutorialShip" highlight="0"/>
                      <remove_offer actor="L2M009.OfferActor" conversation="L2M009 Quit"/>
                      <remove_objective cue="L2M009"/>
                      <do_if value="{object.exists@L2M009.Station}" exact="1">
                        <set_highlight object="L2M009.Station" highlight="0"/>
                      </do_if>
                      <set_command object="TutorialShip" command="idle"/>
                      <reset_cue cue="L2M009 Start Tutorial"/>
                    </do_all>
                  </action>
                </cue>
                <cue name="L2M009 Attacked Instructor" delay="1s" version="2">
                  <condition>
                    <object_relation object="TutorialShip">
                      <relation relation="enemy"/>
                    </object_relation>
                  </condition>
                  <action>
                    <do_all>
                      <set_highlight object="TutorialShip" highlight="0"/>
                      <remove_offer actor="L2M009.OfferActor" conversation="L2M009 Quit"/>
                      <do_if value="{object.exists@L2M009.Station}" exact="1">
                        <set_highlight object="L2M009.Station" highlight="0"/>
                      </do_if>
                      <remove_objective cue="L2M009" status="aborted"/>
                      <cancel_cue cue="L2M009 Must Accelerate"/>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="L2M009 Player Changed Sector" version="2">
                      <condition>
                        <object_changed_sector/>
                      </condition>
                      <action>
                        <do_all>
                          <set_relation object="TutorialShip">
                            <relation relation="friend"/>
                          </set_relation>
                          <set_command object="TutorialShip" command="idle"/>
                          <reset_cue cue="L2M009 Start Tutorial"/>
                        </do_all>
                      </action>
                    </cue>
                  </cues>
                </cue>
                <cue name="L2M009 Must Accelerate" version="2">
                  <timing>
                    <!--this waits for conversation finished?-->
                    <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389103}+1s"/>
                  </timing>
                  <action>
                    <do_all>
                      <play_text actor="L2M009.OfferActor" textid="389104" priority="99"/>
                      <set_objective cue="L2M009" title="{1000,20010}" active="1">
                        <mission level="easy"/>
                        <custom action="{1903,10531}" text="10{35,967}/{35,998}" icon="follow"/>
                      </set_objective>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="L2M009 Must Accelerate Wait">
                      <condition>
                        <cue_completed cue="L2M009 Must Accelerate"/>
                      </condition>
                      <timing>
                        <!--Wait for player to be told to accelerate-->
                        <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389104}+1s"/>
                      </timing>
                      <action>
                        <show_help force="1" key="VK_FASTER"/>
                      </action>
                      <cues>
                        <cue name="L2M009 Accelerate Test" delay="1s">
                          <condition>
                            <check_all>
                              <cue_is_complete cue="L2M009 Must Accelerate Wait"/>
                              <check_value value="{player.ship.speed}" min="10"/>
                            </check_all>
                          </condition>
                          <timing>
                            <time exact="3s"/>
                          </timing>
                          <action>
                            <do_all>
                              <play_text actor="L2M009.OfferActor" textid="389105" priority="99"/>
                              <set_objective cue="L2M009">
                                <custom action="{1903,10532}" text="4{35,967}/{35,998}" icon="follow"/>
                              </set_objective>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="L2M009 Finished Saying Decelerate">
                              <condition>
                                <cue_completed cue="L2M009 Accelerate Test"/>
                              </condition>
                              <timing>
                                <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389105}+2s"/>
                              </timing>
                              <action>
                                <do_all>
                                  <show_help force="1" key="VK_SLOWER"/>
                                  <show_help force="1" key="VK_ZEROSPEED"/>
                                </do_all>
                              </action>
                            </cue>
                            <cue name="L2M009 Decelerate Test" delay="1s">
                              <condition>
                                <check_all>
                                  <check_value value="{player.ship.speed}" max="4"/>
                                  <cue_is_complete cue="L2M009 Finished Saying Decelerate"/>
                                </check_all>
                              </condition>
                              <timing>
                                <time exact="1s"/>
                              </timing>
                              <action>
                                <do_all>
                                  <play_text actor="L2M009.OfferActor" textid="389106" priority="99"/>
                                  <set_objective cue="L2M009">
                                    <custom action="{1903,10532}" text="-5{35,967}/{35,998}" icon="follow"/>
                                  </set_objective>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="L2M009 Finished Saying Reverse">
                                  <condition>
                                    <cue_completed cue="L2M009 Decelerate Test"/>
                                  </condition>
                                  <timing>
                                    <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389106}+2s"/>
                                  </timing>
                                </cue>
                                <cue name="L2M009 Reverse Test" delay="1s">
                                  <condition>
                                    <check_all>
                                      <check_value value="{player.ship.speed}" max="-5"/>
                                      <cue_is_complete cue="L2M009 Finished Saying Reverse"/>
                                    </check_all>
                                  </condition>
                                  <action>
                                    <do_all>
                                      <play_text actor="L2M009.OfferActor" textid="389107" priority="99"/>
                                      <set_command object="TutorialShip" command="idle"/>
                                    </do_all>
                                  </action>
                                  <cues>
                                    <cue name="L2M009 Move to Ship">
                                      <timing>
                                        <time exact="5s"/>
                                      </timing>
                                      <action>
                                        <do_all>
                                          <play_text actor="L2M009.OfferActor" textid="389108" priority="99"/>
                                          <set_value name="L2M009.Check Distance" exact="{object.distance.m@TutorialShip}+500"/>
                                          <set_objective cue="L2M009">
                                            <custom action="{35,2007}" text="{object.name@TutorialShip}" icon="follow" object="TutorialShip"/>
                                          </set_objective>
                                        </do_all>
                                      </action>
                                      <cues>
                                        <cue name="L2M009 Show Movement Gametip">
                                          <condition>
                                            <cue_completed cue="L2M009 Move to Ship"/>
                                          </condition>
                                          <timing>
                                            <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389108}+1s"/>
                                          </timing>
                                          <action>
                                            <show_help textid="25"/>
                                          </action>
                                        </cue>
                                        <cue ref="L2M009 Check Flee From Ship"/>
                                        <cue name="L2M009 Close To Ship" delay="1s">
                                          <condition>
                                            <object_position max="200m">
                                              <position object="TutorialShip"/>
                                            </object_position>
                                          </condition>
                                          <action>
                                            <do_all>
                                              <play_text actor="L2M009.OfferActor" textid="389110" priority="99"/>
                                              <!--needed incase value left over from tutorial before reset-->
                                              <set_value name="L2M009.Crate1Ejected" exact="0"/>
                                              <cancel_cue cue="L2M009 Check Flee From Ship"/>
                                            </do_all>
                                          </action>
                                          <cues>
                                            <cue name="L2M009 Target Crate">
                                              <timing>
                                                <time exact="5s"/>
                                              </timing>
                                              <action>
                                                <do_all>
                                                  <do_choose>
                                                    <do_when value="{value@L2M009.Crate1Ejected}" exact="1">
                                                      <play_text priority="99">
                                                        <line actor="L2M009.OfferActor" textid="389122"/>
                                                        <line actor="L2M009.OfferActor" textid="389112"/>
                                                      </play_text>
                                                    </do_when>
                                                    <do_otherwise>
                                                      <play_text priority="99">
                                                        <line actor="L2M009.OfferActor" textid="389111"/>
                                                        <line actor="L2M009.OfferActor" textid="389112"/>
                                                      </play_text>
                                                      <set_value name="L2M009.Crate1Ejected" exact="1"/>
                                                    </do_otherwise>
                                                  </do_choose>
                                                  <add_cargo object="TutorialShip">
                                                    <ware typename="SS_WARE_DEBRIS" exact="1" critical="1"/>
                                                  </add_cargo>
                                                  <eject_cargo object="TutorialShip">
                                                    <ware name="L2M009.Crate" typename="SS_WARE_DEBRIS" exact="1"/>
                                                  </eject_cargo>
                                                  <set_objective cue="L2M009">
                                                    <custom action="{1903,10576}" text="{object.name@L2M009.Crate}" icon="find" object="L2M009.Crate"/>
                                                  </set_objective>
                                                </do_all>
                                              </action>
                                              <cues>
                                                <cue name="L2M009 Show Tracking Tip">
                                                  <condition>
                                                    <cue_completed cue="L2M009 Target Crate"/>
                                                  </condition>
                                                  <timing>
                                                    <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389122}+5s"/>
                                                  </timing>
                                                  <action>
                                                    <show_help force="1" key="VK_TRACKING"/>
                                                  </action>
                                                </cue>
                                                <cue name="L2M009 Crate Destroyed">
                                                  <condition>
                                                    <object_destroyed object="L2M009.Crate"/>
                                                  </condition>
                                                  <action>
                                                    <do_if value="{object.race@{event.param2}}" exact="{lookup.race@player}">
                                                      <play_text actor="L2M009.OfferActor" textid="389113" priority="99"/>
                                                      <cancel_cue cue="L2M009 Crate Destroyed By Player"/>
                                                    </do_if>
                                                  </action>
                                                  <cues>
                                                    <cue name="L2M009 Reset Crate">
                                                      <timing>
                                                        <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389113}+2s"/>
                                                      </timing>
                                                      <action>
                                                        <reset_cue cue="L2M009 Target Crate"/>
                                                      </action>
                                                    </cue>
                                                  </cues>
                                                </cue>
                                                <cue name="L2M009 Crate Destroyed By Player">
                                                  <condition>
                                                    <object_destroyed_by_player object="L2M009.Crate"/>
                                                  </condition>
                                                  <action>
                                                    <do_all>
                                                      <play_text actor="L2M009.OfferActor" textid="389113" priority="99"/>
                                                      <cancel_cue cue="L2M009 Crate Destroyed"/>
                                                    </do_all>
                                                  </action>
                                                  <cues>
                                                    <cue name="L2M009 Reset Crate">
                                                      <timing>
                                                        <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389113}+2s"/>
                                                      </timing>
                                                      <action>
                                                        <reset_cue cue="L2M009 Target Crate"/>
                                                      </action>
                                                    </cue>
                                                  </cues>
                                                </cue>
                                                <cue name="L2M009 Crate Targeted" version="2">
                                                  <condition>
                                                    <object_targeted object="L2M009.Crate"/>
                                                  </condition>
                                                  <action>
                                                    <do_all>
                                                      <play_text actor="L2M009.OfferActor" textid="389114" priority="99"/>
                                                      <cancel_cue cue="L2M009 Crate Destroyed"/>
                                                      <cancel_cue cue="L2M009 Crate Destroyed By Player"/>
                                                    </do_all>
                                                  </action>
                                                  <cues>
                                                    <cue name="L2M009 Crate Targeted Wait" version="2">
                                                      <timing>
                                                        <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389114}+2s"/>
                                                      </timing>
                                                      <action>
                                                        <do_all>
                                                          <play_text actor="L2M009.OfferActor" textid="389115" priority="99"/>
                                                          <remove_offer actor="L2M009.OfferActor" conversation="L2M009 Quit"/>
                                                          <create_offer actor="L2M009.OfferActor" conversation="L2M009 No2" discipline="XXXT"/>
                                                          <set_objective cue="L2M009">
                                                            <custom action="{35,2012}" text="{actor.name@L2M009.OfferActor}" icon="talkto" actor="L2M009.OfferActor"/>
                                                          </set_objective>
                                                        </do_all>
                                                      </action>
                                                      <cues>
                                                        <cue name="L2M009 Communication Test">
                                                          <condition>
                                                            <conversation_completed actor="L2M009.OfferActor" conversation="L2M009 No2" answer="ready"/>
                                                          </condition>
                                                          <action>
                                                            <do_all>
                                                              <remove_offer actor="L2M009.OfferActor" conversation="L2M009 No2" discipline="XXXT"/>
                                                              <create_offer actor="L2M009.OfferActor" conversation="L2M009 Quit"/>
                                                              <play_text priority="99">
                                                                <line actor="L2M009.OfferActor" textid="389116"/>
                                                                <line actor="L2M009.OfferActor" textid="389117"/>
                                                              </play_text>
                                                              <set_value name="this.WaitTime" exact="{text.duration@{actor.voice@L2M009.OfferActor},389116}+{text.duration@{actor.voice@L2M009.OfferActor},389117}"/>
                                                            </do_all>
                                                          </action>
                                                          <cues>
                                                            <cue name="L2M009 Do Tests" version="2">
                                                              <timing>
                                                                <time exact="{value@L2M009 Communication Test.WaitTime}+2s"/>
                                                              </timing>
                                                              <action>
                                                                <do_all>
                                                                  <find_station name="L2M009.Station" nearest="1" race="default|terran" dockingallowed="1">
                                                                    <sector sector="{player.sector}"/>
                                                                  </find_station>
                                                                  <do_if value="{object.exists@L2M009.Station}" exact="0">
                                                                    <do_if value="{player.gamestart}" exact="117">
                                                                      <find_station name="L2M009.Station" nearest="1" race="yaki" dockingallowed="1">
                                                                        <sector sector="{player.sector}"/>
                                                                      </find_station>
                                                                    </do_if>
                                                                  </do_if>
                                                                  <!--needed incase value left over from tutorial before reset-->
                                                                  <set_value name="L2M009.StationTest" exact="0"/>
                                                                  <set_value name="L2M009.CombatTest" exact="0"/>
                                                                  <do_choose>
                                                                    <do_when value="{object.exists@L2M009.Station}" exact="1">
                                                                      <set_value name="L2M009.StationTest" exact="1"/>
                                                                    </do_when>
                                                                    <do_otherwise>
                                                                      <set_value name="L2M009.CombatTest" exact="1"/>
                                                                    </do_otherwise>
                                                                  </do_choose>
                                                                </do_all>
                                                              </action>
                                                              <cues>
                                                                <cue name="L2M009 Station Test" delay="2s">
                                                                  <condition>
                                                                    <check_value value="{value@L2M009.StationTest}" exact="1"/>
                                                                  </condition>
                                                                  <action>
                                                                    <do_all>
                                                                      <play_text actor="L2M009.OfferActor" textid="389118" priority="99"/>
                                                                      <set_command object="TutorialShip" command="follow" commandobject="L2M009.Station" distance="5km"/>
                                                                      <set_highlight object="L2M009.Station" highlight="1"/>
                                                                      <set_objective cue="L2M009">
                                                                        <custom action="{35,2005}" text="{object.name@L2M009.Station}" icon="find" object="L2M009.Station"/>
                                                                      </set_objective>
                                                                    </do_all>
                                                                  </action>
                                                                  <cues>
                                                                    <cue name="L2M009 Stay Near Station">
                                                                      <condition>
                                                                        <object_finished object="TutorialShip"/>
                                                                      </condition>
                                                                      <action>
                                                                        <set_command object="TutorialShip" command="stay"/>
                                                                      </action>
                                                                    </cue>
                                                                    <cue name="L2M009 Set Station Target">
                                                                      <timing>
                                                                        <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389118}+1s"/>
                                                                      </timing>
                                                                      <action>
                                                                        <set_target object="L2M009.Station"/>
                                                                      </action>
                                                                    </cue>
                                                                    <cue name="L2M009 Player Docked" version="2">
                                                                      <condition>
                                                                        <object_docked param="{object@L2M009.Station}"/>
                                                                      </condition>
                                                                      <timing>
                                                                        <time exact="13s"/>
                                                                      </timing>
                                                                      <action>
                                                                        <do_all>
                                                                          <set_highlight object="L2M009.Station" highlight="0"/>
                                                                          <remove_object object="L2M009.Station"/>
                                                                          <play_text actor="L2M009.OfferActor" textid="389119" priority="99"/>
                                                                        </do_all>
                                                                      </action>
                                                                      <cues>
                                                                        <cue name="L2M009 Undock From Station">
                                                                          <condition>
                                                                            <cue_completed cue="L2M009 Player Docked"/>
                                                                          </condition>
                                                                          <timing>
                                                                            <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389119}"/>
                                                                          </timing>
                                                                          <cues>
                                                                            <cue name="L2M009 Player Undocked" delay="503">
                                                                              <condition>
                                                                                <check_all>
                                                                                  <object_is_docked negate="1"/>
                                                                                  <cue_is_complete cue="L2M009 Undock From Station"/>
                                                                                </check_all>
                                                                              </condition>
                                                                              <action>
                                                                                <do_all>
                                                                                  <set_value name="L2M009.CombatTest" exact="1"/>
                                                                                  <set_command object="TutorialShip" command="stay"/>
                                                                                  <cancel_cue cue="L2M009 Stay Near Station"/>
                                                                                </do_all>
                                                                              </action>
                                                                            </cue>
                                                                          </cues>
                                                                        </cue>
                                                                      </cues>
                                                                    </cue>
                                                                  </cues>
                                                                </cue>
                                                                <cue name="L2M009 Combat Test" delay="1107" version="2">
                                                                  <condition>
                                                                    <check_value value="{value@L2M009.CombatTest}" exact="1"/>
                                                                  </condition>
                                                                  <action>
                                                                    <do_all>
                                                                      <set_command object="TutorialShip" command="idle"/>
                                                                      <cancel_cue cue="L2M009 Station Test"/>
                                                                      <play_text priority="99">
                                                                        <line actor="L2M009.OfferActor" textid="389120"/>
                                                                        <line actor="L2M009.OfferActor" textid="389121"/>
                                                                      </play_text>
                                                                      <set_value name="L2M009.Check Distance" exact="{object.distance.m@TutorialShip}+500"/>
                                                                      <set_objective cue="L2M009">
                                                                        <mission level="average"/>
                                                                        <custom action="{35,2007}" text="{object.name@TutorialShip}" icon="find" object="TutorialShip"/>
                                                                      </set_objective>
                                                                    </do_all>
                                                                  </action>
                                                                  <cues>
                                                                    <cue ref="L2M009 Check Flee From Ship"/>
                                                                    <cue name="L2M009 Destroy Crate" delay="2s">
                                                                      <condition>
                                                                        <object_position max="500m">
                                                                          <position object="TutorialShip"/>
                                                                        </object_position>
                                                                      </condition>
                                                                      <action>
                                                                        <do_all>
                                                                          <cancel_cue cue="L2M009 Check Flee From Ship"/>
                                                                          <play_text priority="99">
                                                                            <line actor="L2M009.OfferActor" textid="389122"/>
                                                                            <line actor="L2M009.OfferActor" textid="389123"/>
                                                                          </play_text>
                                                                          <add_cargo object="TutorialShip">
                                                                            <ware typename="SS_WARE_DEBRIS" exact="1" critical="1"/>
                                                                          </add_cargo>
                                                                          <eject_cargo object="TutorialShip">
                                                                            <ware name="L2M009.Crate" typename="SS_WARE_DEBRIS" exact="1"/>
                                                                          </eject_cargo>
                                                                          <set_objective cue="L2M009">
                                                                            <custom action="{35,2004}" text="{object.name@L2M009.Crate}" icon="find" object="L2M009.Crate"/>
                                                                          </set_objective>
                                                                        </do_all>
                                                                      </action>
                                                                      <cues>
                                                                        <cue name="L2M009 Fire Missile Tip">
                                                                          <condition>
                                                                            <cue_completed cue="L2M009 Destroy Crate"/>
                                                                          </condition>
                                                                          <timing>
                                                                            <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389122}+{text.duration@{actor.voice@L2M009.OfferActor},389123}+2s"/>
                                                                          </timing>
                                                                          <action>
                                                                            <do_all>
                                                                              <show_help force="1" key="VK_FIRE"/>
                                                                              <show_help force="1" key="VK_CURSORFIRE"/>
                                                                            </do_all>
                                                                          </action>
                                                                        </cue>
                                                                        <cue name="L2M009 Crate Destroyed 2">
                                                                          <condition>
                                                                            <object_destroyed object="L2M009.Crate"/>
                                                                          </condition>
                                                                          <timing>
                                                                            <time min="2s" max="3s"/>
                                                                          </timing>
                                                                          <action>
                                                                            <reset_cue cue="L2M009 Destroy Crate"/>
                                                                          </action>
                                                                        </cue>
                                                                        <cue name="L2M009 Crate Destroyed By Player 2">
                                                                          <condition>
                                                                            <check_all>
                                                                              <object_destroyed_by_player object="L2M009.Crate"/>
                                                                              <object_destroyed_by_player object="L2M009.Crate" param="2" negate="1"/>
                                                                            </check_all>
                                                                          </condition>
                                                                          <action>
                                                                            <do_all>
                                                                              <play_text actor="L2M009.OfferActor" textid="389113" priority="99"/>
                                                                              <cancel_cue cue="L2M009 Crate Destroyed 2"/>
                                                                            </do_all>
                                                                          </action>
                                                                          <cues>
                                                                            <cue name="L2M009 Reset Crate2">
                                                                              <timing>
                                                                                <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389113}+2s"/>
                                                                              </timing>
                                                                              <action>
                                                                                <do_all>
                                                                                  <set_objective cue="L2M009">
                                                                                    <flyto object="TutorialShip"/>
                                                                                  </set_objective>
                                                                                  <reset_cue cue="L2M009 Destroy Crate"/>
                                                                                </do_all>
                                                                              </action>
                                                                            </cue>
                                                                          </cues>
                                                                        </cue>
                                                                        <cue name="L2M009 Crate Destroyed By Player Laser" version="2">
                                                                          <condition>
                                                                            <object_destroyed_by_player object="L2M009.Crate" param="2"/>
                                                                          </condition>
                                                                          <action>
                                                                            <do_all>
                                                                              <cancel_cue cue="L2M009 Crate Destroyed By Player 2"/>
                                                                              <set_objective cue="L2M009">
                                                                                <flyto object="TutorialShip"/>
                                                                              </set_objective>
                                                                              <play_text actor="L2M009.OfferActor" textid="389108" priority="99"/>
                                                                            </do_all>
                                                                          </action>
                                                                          <cues>
                                                                            <cue name="L2M009 Missile Test" version="2">
                                                                              <condition>
                                                                                <object_position max="1500m">
                                                                                  <position object="TutorialShip"/>
                                                                                </object_position>
                                                                              </condition>
                                                                              <timing>
                                                                                <time min="2s" max="3s"/>
                                                                              </timing>
                                                                              <action>
                                                                                <do_all>
                                                                                  <play_text priority="99">
                                                                                    <line actor="L2M009.OfferActor" textid="389122"/>
                                                                                    <line actor="L2M009.OfferActor" textid="389124"/>
                                                                                  </play_text>
                                                                                  <add_cargo object="TutorialShip">
                                                                                    <ware typename="SS_WARE_DEBRIS" exact="1" critical="1"/>
                                                                                  </add_cargo>
                                                                                  <eject_cargo object="TutorialShip">
                                                                                    <ware name="L2M009.Crate" typename="SS_WARE_DEBRIS" exact="1"/>
                                                                                  </eject_cargo>
                                                                                  <do_if value="{value@L2M009 Missile Test}" exact="0">
                                                                                    <set_value name="L2M009 Missile Test" exact="1"/>
                                                                                    <do_choose>
                                                                                      <do_when value="{lookup.race.mask.terrangroup@{player.ship.maker}}" exact="1">
                                                                                        <add_cargo>
                                                                                          <ware typename="SS_MISSILE_POLTERGEIST" exact="1" critical="1"/>
                                                                                        </add_cargo>
                                                                                        <play_sound soundid="991"/>
                                                                                      </do_when>
                                                                                      <do_otherwise>
                                                                                        <add_cargo>
                                                                                          <ware typename="SS_MISSILE_A" exact="1" critical="1"/>
                                                                                        </add_cargo>
                                                                                        <play_sound soundid="991"/>
                                                                                      </do_otherwise>
                                                                                    </do_choose>
                                                                                  </do_if>
                                                                                  <set_objective cue="L2M009">
                                                                                    <custom action="{35,2004}" text="{object.name@L2M009.Crate}" icon="destroy" object="L2M009.Crate"/>
                                                                                  </set_objective>
                                                                                  <!--needed incase value left over from tutorial before reset-->
                                                                                  <set_value name="L2M009.Do Final Section" exact="0"/>
                                                                                </do_all>
                                                                              </action>
                                                                              <cues>
                                                                                <cue name="L2M009 Target Crate Before Missile" delay="1s">
                                                                                  <condition>
                                                                                    <check_all>
                                                                                      <cue_is_complete cue="L2M009 Missile Test"/>
                                                                                      <check_value value="{player.target}" exact="{object@L2M009.Crate}"/>
                                                                                    </check_all>
                                                                                  </condition>
                                                                                  <action>
                                                                                    <do_all>
                                                                                      <show_help force="1" key="VK_SELECTMISSILE"/>
                                                                                      <show_help force="1" key="VK_LAUNCHMISSILE"/>
                                                                                    </do_all>
                                                                                  </action>
                                                                                </cue>
                                                                                <cue name="L2M009 Crate Destroyed By Player 3">
                                                                                  <condition>
                                                                                    <check_all>
                                                                                      <object_destroyed_by_player object="L2M009.Crate"/>
                                                                                      <object_destroyed_by_player object="L2M009.Crate" param="5" negate="1"/>
                                                                                    </check_all>
                                                                                  </condition>
                                                                                  <action>
                                                                                    <do_all>
                                                                                      <play_text actor="L2M009.OfferActor" textid="389113" priority="99"/>
                                                                                      <cancel_cue cue="L2M009 Crate Destroyed 3"/>
                                                                                      <set_value name="L2M009.Do Final Section" exact="1"/>
                                                                                    </do_all>
                                                                                  </action>
                                                                                </cue>
                                                                                <cue name="L2M009 Crate Destroyed 3">
                                                                                  <condition>
                                                                                    <object_destroyed object="L2M009.Crate"/>
                                                                                  </condition>
                                                                                  <action>
                                                                                    <set_value name="L2M009.Do Final Section" exact="1"/>
                                                                                  </action>
                                                                                </cue>
                                                                                <cue name="L2M009 Crate Destroyed By Missile">
                                                                                  <condition>
                                                                                    <object_destroyed_by_player object="L2M009.Crate" param="5"/>
                                                                                  </condition>
                                                                                  <action>
                                                                                    <do_all>
                                                                                      <play_text actor="L2M009.OfferActor" textid="389125" priority="99"/>
                                                                                      <cancel_cue cue="L2M009 Target Crate Before Missile"/>
                                                                                      <set_value name="L2M009.Do Final Section" exact="1"/>
                                                                                    </do_all>
                                                                                  </action>
                                                                                </cue>
                                                                                <cue name="L2M009 Out Of Missiles" delay="500" version="2">
                                                                                  <condition>
                                                                                    <check_all>
                                                                                      <check_value value="{value@L2M009.Do Final Section}" exact="0"/>
                                                                                      <check_any>
                                                                                        <check_all>
                                                                                          <check_value value="{lookup.race.mask.terrangroup@{player.ship.maker}}" exact="1"/>
                                                                                          <check_value value="{player.ship.cargo.SS_MISSILE_POLTERGEIST.count}" max="0"/>
                                                                                        </check_all>
                                                                                        <check_all>
                                                                                          <check_value value="{lookup.race.mask.terrangroup@{player.ship.maker}}" exact="0"/>
                                                                                          <check_value value="{player.ship.cargo.SS_MISSILE_A.count}" max="0"/>
                                                                                        </check_all>
                                                                                      </check_any>
                                                                                      <check_all>
                                                                                        <check_value value="{object.exists@L2M009.Crate}" exact="1"/>
                                                                                        <check_value value="{object.incomingmissile.exists@L2M009.Crate}" exact="0"/>
                                                                                      </check_all>
                                                                                    </check_all>
                                                                                  </condition>
                                                                                  <action>
                                                                                    <do_all>
                                                                                      <play_text actor="L2M009.OfferActor" textid="389112" priority="99"/>
                                                                                      <cancel_cue cue="L2M009 Crate Destroyed By Missile"/>
                                                                                      <cancel_cue cue="L2M009 Crate Destroyed 3"/>
                                                                                      <cancel_cue cue="L2M009 Crate Destroyed By Player 3"/>
                                                                                      <cancel_cue cue="L2M009 Target Crate Before Missile"/>
                                                                                      <set_value name="L2M009.Do Final Section" exact="1"/>
                                                                                    </do_all>
                                                                                  </action>
                                                                                </cue>
                                                                                <cue name="L2M009 Finish Tutorial">
                                                                                  <condition>
                                                                                    <check_value value="{value@L2M009.Do Final Section}" exact="1"/>
                                                                                  </condition>
                                                                                  <cues>
                                                                                    <cue name="L2M009 Shield Check">
                                                                                      <timing>
                                                                                        <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389125}+2s"/>
                                                                                      </timing>
                                                                                      <action>
                                                                                        <do_all>
                                                                                          <set_value name="L2M009.PlayerShipShields" exact="{player.ship.shields}"/>
                                                                                          <set_object name="L2M009.PlayerShip" value="{player.ship}"/>
                                                                                          <set_shield object="L2M009.PlayerShip" exact="20"/>
                                                                                          <play_text actor="L2M009.OfferActor" textid="389126" priority="99"/>
                                                                                        </do_all>
                                                                                      </action>
                                                                                      <cues>
                                                                                        <cue name="L2M009 Shield Restore" version="4">
                                                                                          <documentation>
                                                                                            <history>
                                                                                              <change date="22/03/2010" author="Owen Lake" description="Moved achievement to different cue"/>
                                                                                              <change date="20/01/2010" author="Owen Lake" description="Added achievement"/>
                                                                                            </history>
                                                                                          </documentation>
                                                                                          <timing>
                                                                                            <time exact="{text.duration@{actor.voice@L2M009.OfferActor},389126}+3s"/>
                                                                                          </timing>
                                                                                          <action>
                                                                                            <do_all>
                                                                                              <cancel_cue cue="L2M009 Left Sector"/>
                                                                                              <set_shield object="L2M009.PlayerShip" exact="{value@L2M009.PlayerShipShields}"/>
                                                                                              <remove_object object="L2M009.PlayerShip"/>
                                                                                              <set_value name="L2M009.EndTextDuration" exact="{player.age}+{text.duration.s@{actor.voice@L2M009.OfferActor},389127}+{text.duration.s@{actor.voice@L2M009.OfferActor},389128}"/>
                                                                                              <set_highlight object="TutorialShip" highlight="0"/>
                                                                                              <set_invincible object="TutorialShip" invincible="0"/>
                                                                                              <set_command object="TutorialShip" command="idle"/>
                                                                                              <remove_offer actor="L2M009.OfferActor" conversation="L2M009 Quit"/>
                                                                                              <remove_objective cue="L2M009" status="complete"/>
                                                                                              <play_text priority="99">
                                                                                                <line actor="L2M009.OfferActor" textid="389127"/>
                                                                                                <line actor="L2M009.OfferActor" textid="389128"/>
                                                                                              </play_text>
                                                                                            </do_all>
                                                                                          </action>
                                                                                          <cues>
                                                                                            <cue name="L2M009 Reward Achievement" delay="1s">
                                                                                              <condition>
                                                                                                <check_all>
                                                                                                  <cue_is_complete cue="L2M009 Shield Restore"/>
                                                                                                  <check_age min="{value@L2M009.EndTextDuration}"/>
                                                                                                </check_all>
                                                                                              </condition>
                                                                                              <action>
                                                                                                <do_all>
                                                                                                  <unlock_achievement name="FLIGHT_SCHOOL"/>
                                                                                                  <set_value name="L2M009.TutorialStage" exact="2"/>
                                                                                                </do_all>
                                                                                              </action>
                                                                                            </cue>
                                                                                          </cues>
                                                                                        </cue>
                                                                                      </cues>
                                                                                    </cue>
                                                                                  </cues>
                                                                                </cue>
                                                                              </cues>
                                                                            </cue>
                                                                          </cues>
                                                                        </cue>
                                                                      </cues>
                                                                    </cue>
                                                                  </cues>
                                                                </cue>
                                                              </cues>
                                                            </cue>
                                                          </cues>
                                                        </cue>
                                                      </cues>
                                                    </cue>
                                                  </cues>
                                                </cue>
                                              </cues>
                                            </cue>
                                          </cues>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>

        <cue name="L2M009 Instructor Orders">
          <condition>
            <object_finished object="TutorialShip"/>
          </condition>
          <action>
            <set_command object="TutorialShip" command="idle"/>
          </action>
        </cue>
        <cue name="L2M009 Check Flee From Ship" library="1">
          <condition>
            <cue_is_complete cue="L2M009 Move to Ship"/>
          </condition>
          <action>
            <do_choose>
              <!--set the distance as 5km if near to ship-->
              <do_when value="{object.distance.m@TutorialShip}" max="4500">
                <set_value name="L2M009.Check Distance" exact="5000"/>
                <cancel_cue cue="L2M009 Closer To Ship"/>
              </do_when>
              <!--else set the distance as abit further than players current position if it wont increase the check distance-->
              <do_when value="{object.distance.m@TutorialShip}+500" max="{value@L2M009.Check Distance}">
                <set_value name="L2M009.Check Distance" exact="{object.distance.m@TutorialShip}+500"/>
              </do_when>
            </do_choose>
          </action>
          <cues>
            <cue name="L2M009 Flee From Ship" delay="2001">
              <condition>
                <object_position min="{value@L2M009.Check Distance}m">
                  <position object="TutorialShip"/>
                </object_position>
              </condition>
              <timing>
                <time exact="250"/>
              </timing>
              <action>
                <do_all>
                  <!--player is flying away so ask where he going-->
                  <play_text actor="L2M009.OfferActor" textid="389109" priority="99"/>
                  <!--only send the message once-->
                  <cancel_cue cue="L2M009 Closer To Ship"/>
                </do_all>
              </action>
            </cue>
            <cue name="L2M009 Closer To Ship" delay="1983">
              <condition>
                <object_position max="({value@L2M009.Check Distance}-1000)m">
                  <position object="TutorialShip"/>
                </object_position>
              </condition>
              <action>
                <!--player is getting closer, so reset distance check-->
                <reset_cue cue="L2M009 Check Flee From Ship"/>
              </action>
            </cue>
          </cues>
        </cue>
        <!--Additional Scenarios-->
        <cue name="L2M009_MoreScenarios" delay="3s">
          <condition>
            <check_all>
              <cue_is_complete cue="L2M009"/>
              <check_value value="{value@L2M009.TutorialStage}" exact="2"/>
            </check_all>
          </condition>
          <action>
            <do_all>
              <create_actor name="L2M009.Instructor" character="{random.pilot.argon}" race="argon" gender="male" voice="110" location="crew" object="L2M009.Outpost" invincible="1"/>
              <create_actor name="L2M009.FightInstructor" character="{random.pilot.split}" race="split" gender="male" voice="310" location="crew" object="L2M009.Outpost" invincible="1"/>
              <set_value name="L2M009.GateCount" exact="1"/>
              <create_ship typename="SS_SH_R1" race="player" dockobject="L2M009.Outpost">
                <sector sector="{player.sector}"/>
                <equipment loadout="maximum" loadoutmask="all"/>
              </create_ship>
              <create_ship typename="SS_SH_R2" race="player" dockobject="L2M009.Outpost">
                <sector sector="{player.sector}"/>
                <equipment loadout="maximum" loadoutmask="all"/>
              </create_ship>
              <create_ship typename="SS_SH_A_M5" race="player" dockobject="L2M009.Outpost">
                <sector sector="{player.sector}"/>
                <equipment loadout="maximum" loadoutmask="all"/>
              </create_ship>
              <create_ship typename="SS_SH_B_M4" race="player" dockobject="L2M009.Outpost">
                <sector sector="{player.sector}"/>
                <equipment loadout="maximum" loadoutmask="all"/>
              </create_ship>
              <create_ship typename="SS_SH_S_M3" race="player" dockobject="L2M009.Outpost">
                <sector sector="{player.sector}"/>
                <equipment loadout="maximum" loadoutmask="all"/>
              </create_ship>
              <create_ship typename="SS_SH_T_M5P" race="player" dockobject="L2M009.Outpost">
                <sector sector="{player.sector}"/>
                <equipment loadout="maximum" loadoutmask="all"/>
              </create_ship>
              <create_ship typename="SS_SH_A_M6" race="player" dockobject="L2M009.Outpost">
                <sector sector="{player.sector}"/>
                <equipment loadout="maximum" loadoutmask="all"/>
              </create_ship>
              <create_ship typename="SS_SH_B_M2" race="player" dockobject="L2M009.Outpost">
                <sector sector="{player.sector}"/>
                <equipment loadout="maximum" loadoutmask="all"/>
              </create_ship>
              <create_ship typename="SS_SH_P_M1" race="player" dockobject="L2M009.Outpost">
                <sector sector="{player.sector}"/>
                <equipment loadout="maximum" loadoutmask="all"/>
              </create_ship>
            </do_all>
          </action>
          <cues>
            <cue name="L2M009_RingRaceTutorial" delay="2s">
              <condition>
                <check_all>
                  <cue_is_complete cue="L2M009_MoreScenarios"/>
                </check_all>
              </condition>
              <action>
                <do_all>
                  <create_offer actor="L2M009.Instructor" conversation="RingRace" cue="L2M009_RingRaceTutorial" discipline="XXXXP"/>
                  <set_objective cue="L2M009" title="{3202,12}">
                    <mission level="trivial"/>
                    <talkto actor="L2M009.Instructor"/>
                  </set_objective>
                </do_all>
              </action>
              <cues>
                <cue name="L2M009_Ringrun">
                  <condition>
                    <conversation_completed actor="L2M009.Instructor" conversation="RingRace" answer="accept"/>
                  </condition>
                  <action>
                    <do_all>
                      <remove_offer actor="L2M009.Instructor" conversation="RingRace" discipline="XXXXP"/>
                      <remove_objective cue="L2M009"/>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="L2M009_Flytogate" delay="141">
                      <condition>
                        <check_all>
                          <cue_is_complete cue="L2M009_Ringrun"/>
                          <check_value value="{value@L2M009.GateCount}" exact="7" negate="1"/>
                        </check_all>
                      </condition>
                      <action>
                        <do_all>
                          <set_objective cue="L2M009" title="{3202,12}">
                            <mission level="easy"/>
                            <flyto object="L2M009.InactiveGate{value@L2M009.GateCount}"/>
                          </set_objective>
                          <set_target object="L2M009.InactiveGate{value@L2M009.GateCount}"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="L2M009_PassedGate" delay="321">
                          <condition>
                            <check_all>
                              <cue_is_complete cue="L2M009_Flytogate"/>
                              <object_position object="{player.ship}" max="950m">
                                <position object="L2M009.InactiveGate{value@L2M009.GateCount}"/>
                                <sector sector="{player.sector}"/>
                              </object_position>
                            </check_all>
                          </condition>
                          <action>
                            <do_all>
                              <set_value name="L2M009.GateCount" operation="add" exact="1"/>
                              <reset_cue cue="L2M009_Flytogate"/>
                            </do_all>
                          </action>
                        </cue>
                      </cues>
                    </cue>
                    <cue name="L2M009_RunComplete" delay="1s">
                      <condition>
                        <check_all>
                          <cue_is_complete cue="L2M009_Ringrun"/>
                          <check_value value="{value@L2M009.GateCount}" exact="7"/>
                        </check_all>
                      </condition>
                      <action>
                        <do_all>
                          <set_target object="L2M009.Outpost"/>
                          <remove_objective cue="L2M009" status="complete"/>
                          <play_text actor="L2M009.Instructor" textid="389107" priority="99"/>
                          <set_value name="L2M009.TutorialStage" exact="3"/>
                          <set_value name="L2M009.GateCount" exact="1"/>
                          <reset_cue cue="L2M009_RingRaceTutorial"/>
                        </do_all>
                      </action>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>

    <!--Combat Training Basic-->
    <cue name="L2M009B" check="cancel">
      <condition>
        <check_all>
          <check_value value="{player.gamestart}" exact="102"/>
        </check_all>
      </condition>
      <action>
        <do_all>
          <find_object name="L2M009B.Spawnpoint" typename="SS_SPECIAL_INVMARKER" nearest="1">
            <position x="-2km" y="-22km" z="-37km" max="1km"/>
            <sector sector="{player.sector}"/>
          </find_object>
          <find_station name="L2M009B.Outpost" typename="SS_DOCK_A_MILITARY">
            <sector sector="{player.sector}"/>
          </find_station>
          <set_invincible object="L2M009B.Outpost" invincible="1"/>
          <create_actor name="L2M009B.FightInstructor" character="{random.pilot.split}" race="split" gender="male" voice="310" location="crew" object="L2M009B.Outpost" invincible="1"/>
          <do_all min="2" max="4">
            <create_ship group="L2M009B.EnemyGroup" race="xenon" typename="SS_SH_X_M5" racelogic="0" warp="1">
              <position object="L2M009B.Spawnpoint" max="1km"/>
              <sector sector="{player.sector}"/>
              <equipment loadout="default" loadoutmask="all"/>
              <command command="killenemies"/>
            </create_ship>
          </do_all>
        </do_all>
      </action>
      <cues>
        <cue name="L2M009B_Intro" delay="1s">
          <condition>
            <check_all>
              <cue_is_complete cue="L2M009B"/>
            </check_all>
          </condition>
          <timing>
            <time exact="4s"/>
          </timing>
          <action>
            <do_all>
              <play_text actor="L2M009B.FightInstructor" priority="99">
                <line pageid="310" textid="925" comment="We welcome your arrival!"/>
                <line pageid="310" textid="802" comment="You pick right moment!"/>
                <line pageid="310" textid="804" comment="I search for a pilot who fights with honour."/>
                <line pageid="310" textid="830" comment="The mission will be easy for the likes of you."/>
                <line pageid="310" textid="835" comment="Enemies will be present during your journey."/>
              </play_text>
            </do_all>
          </action>
          <cues>
            <cue name="L2M009B_Task" delay="1s">
              <condition>
                <check_all>
                  <cue_is_complete cue="L2M009B_Intro"/>
                </check_all>
              </condition>
              <timing>
                <time exact="1s"/>
              </timing>
              <action>
                <do_all>
                  <set_objective cue="L2M009B_Task" title="{1900,5201}" noabort="1">
                    <mission level="average"/>
                    <destroy object="{group.nearest@L2M009B.EnemyGroup}"/>
                  </set_objective>
                </do_all>
              </action>
              <cues>
                <cue name="L2M009B_Objective">
                  <condition>
                    <check_any>
                      <any_object_destroyed group="L2M009B.EnemyGroup"/>
                      <any_object_destroyed_by_player group="L2M009B.EnemyGroup"/>
                    </check_any>
                  </condition>
                  <timing>
                    <time exact="1s"/>
                  </timing>
                  <action>
                    <do_all>
                      <do_choose>
                        <do_when value="{group.object.count@L2M009B.EnemyGroup}" min="1">
                          <remove_objective cue="L2M009B_Task"/>
                          <reset_cue cue="L2M009B_Task"/>
                        </do_when>
                        <do_otherwise>
                          <remove_objective cue="L2M009B_Task" status="complete"/>
                        </do_otherwise>
                      </do_choose>
                    </do_all>
                  </action>
                </cue>
                <cue name="L2M009B_End" delay="2s">
                  <condition>
                    <check_all>
                      <cue_is_complete cue="L2M009B_Intro"/>
                      <any_object_exists group="L2M009B.EnemyGroup" negate="1"/>
                    </check_all>
                  </condition>
                  <action>
                    <do_all>
                      <do_all>
                        <play_text actor="L2M009B.FightInstructor" priority="99">
                          <line pageid="310" textid="841" comment="You have performed an excellent job."/>
                          <line pageid="310" textid="851" comment="There is no more time. That's it."/>
                        </play_text>
                      </do_all>
                    </do_all>
                  </action>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>

    <!--Combat Training Medium-->
    <cue name="L2M009M" delay="4s" check="cancel">
      <condition>
        <check_all>
          <check_value value="{player.gamestart}" exact="103"/>
        </check_all>
      </condition>
      <action>
        <do_all>
          <find_object name="L2M009M.Spawnpoint" typename="SS_SPECIAL_INVMARKER" nearest="1">
            <position x="-2km" y="-22km" z="-37km" max="1km"/>
            <sector sector="{player.sector}"/>
          </find_object>
          <find_station name="L2M009M.Outpost" typename="SS_DOCK_A_MILITARY">
            <sector sector="{player.sector}"/>
          </find_station>
          <set_invincible object="L2M009M.Outpost" invincible="1"/>
          <create_actor name="L2M009M.FightInstructor" character="{random.pilot.split}" race="split" gender="male" voice="310" location="crew" object="L2M009M.Outpost" invincible="1"/>
          <do_all min="6" max="9">
            <create_ship group="L2M009M.EnemyGroup" race="xenon" typename="{random.type@SS_SH_X_M5|SS_SH_X_M4}" racelogic="0" warp="1">
              <position object="L2M009M.Spawnpoint" max="1km"/>
              <sector sector="{player.sector}"/>
              <equipment loadout="maximum" loadoutmask="all"/>
              <command command="killenemies"/>
            </create_ship>
          </do_all>
        </do_all>
      </action>
      <cues>
        <cue name="L2M009M_Intro" delay="1s">
          <condition>
            <check_all>
              <cue_is_complete cue="L2M009M"/>
            </check_all>
          </condition>
          <timing>
            <time exact="4s"/>
          </timing>
          <action>
            <do_all>
              <play_text actor="L2M009M.FightInstructor" priority="99">
                <line pageid="310" textid="925" comment="We welcome your arrival!"/>
                <line pageid="310" textid="802" comment="You pick right moment!"/>
                <line pageid="310" textid="804" comment="I search for a pilot who fights with honour."/>
                <line pageid="310" textid="831" comment="You may find things tricky, maybe."/>
                <line pageid="310" textid="835" comment="Enemies will be present during your journey."/>
              </play_text>
            </do_all>
          </action>
          <cues>
            <cue name="L2M009M_Task" delay="1s">
              <condition>
                <check_all>
                  <cue_is_complete cue="L2M009M_Intro"/>
                </check_all>
              </condition>
              <timing>
                <time exact="1s"/>
              </timing>
              <action>
                <do_all>
                  <set_objective cue="L2M009M_Task" title="{1900,5201}" noabort="1">
                    <mission level="average"/>
                    <destroy object="{group.nearest@L2M009M.EnemyGroup}"/>
                  </set_objective>
                </do_all>
              </action>
              <cues>
                <cue name="L2M009M_Objective">
                  <condition>
                    <check_any>
                      <any_object_destroyed group="L2M009M.EnemyGroup"/>
                      <any_object_destroyed_by_player group="L2M009M.EnemyGroup"/>
                    </check_any>
                  </condition>
                  <timing>
                    <time exact="1s"/>
                  </timing>
                  <action>
                    <do_all>
                      <do_choose>
                        <do_when value="{group.object.count@L2M009M.EnemyGroup}" min="1">
                          <remove_objective cue="L2M009M_Task"/>
                          <reset_cue cue="L2M009M_Task"/>
                        </do_when>
                        <do_otherwise>
                          <remove_objective cue="L2M009M_Task" status="complete"/>
                        </do_otherwise>
                      </do_choose>
                    </do_all>
                  </action>
                </cue>
                <cue name="L2M009M_End" delay="2s">
                  <condition>
                    <check_all>
                      <cue_is_complete cue="L2M009M_Intro"/>
                      <any_object_exists group="L2M009M.EnemyGroup" negate="1"/>
                    </check_all>
                  </condition>
                  <action>
                    <do_all>
                      <do_all>
                        <play_text actor="L2M009M.FightInstructor" priority="99">
                          <line pageid="310" textid="841" comment="You have performed an excellent job."/>
                          <line pageid="310" textid="851" comment="There is no more time. That's it."/>
                        </play_text>
                      </do_all>
                    </do_all>
                  </action>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>

    <!--Combat Training Advanced-->
    <cue name="L2M009A" delay="3s" check="cancel">
      <condition>
        <check_all>
          <check_value value="{player.gamestart}" exact="104"/>
        </check_all>
      </condition>
      <action>
        <do_all>
          <find_object name="L2M009A.Spawnpoint" typename="SS_SPECIAL_INVMARKER" nearest="1">
            <position x="-2km" y="-22km" z="-37km" max="1km"/>
            <sector sector="{player.sector}"/>
          </find_object>
          <find_station name="L2M009.Outpost" typename="SS_DOCK_A_MILITARY">
            <sector sector="{player.sector}"/>
          </find_station>
          <set_invincible object="L2M009A.Outpost" invincible="1"/>
          <create_actor name="L2M009A.FightInstructor" character="{random.pilot.split}" race="split" gender="male" voice="310" location="crew" object="L2M009A.Outpost" invincible="1"/>
          <do_all min="6" max="9">
            <create_ship group="L2M009A.EnemyGroup" race="xenon" typename="{random.type@SS_SH_X_M3|SS_SH_X_M4|SS_SH_X_M5}" racelogic="0" warp="1">
              <position object="L2M009A.Spawnpoint" max="1km"/>
              <sector sector="{player.sector}"/>
              <equipment loadout="maximum" loadoutmask="all"/>
              <command command="killenemies"/>
            </create_ship>
          </do_all>
          <do_all min="1" max="2">
            <create_ship group="L2M009A.EnemyGroup" race="xenon" typename="SS_SH_X_M6" racelogic="0" warp="1">
              <position object="L2M009A.Spawnpoint" max="1km"/>
              <sector sector="{player.sector}"/>
              <equipment loadout="maximum" loadoutmask="all"/>
              <command command="killenemies"/>
            </create_ship>
          </do_all>
          <create_ship group="L2M009A.EnemyGroup" race="xenon" typename="SS_SH_X_M2" racelogic="0" warp="1">
            <position object="L2M009A.Spawnpoint" max="1km"/>
            <sector sector="{player.sector}"/>
            <equipment loadout="maximum" loadoutmask="all"/>
            <command command="killenemies"/>
          </create_ship>
        </do_all>
      </action>
      <cues>
        <cue name="L2M009A_Intro" delay="1s">
          <condition>
            <check_all>
              <cue_is_complete cue="L2M009A"/>
            </check_all>
          </condition>
          <timing>
            <time exact="4s"/>
          </timing>
          <action>
            <do_all>
              <play_text actor="L2M009A.FightInstructor" priority="99">
                <line pageid="310" textid="925" comment="We welcome your arrival!"/>
                <line pageid="310" textid="802" comment="You pick right moment!"/>
                <line pageid="310" textid="804" comment="I search for a pilot who fights with honour."/>
                <line pageid="310" textid="832" comment="The mission could be hard for the likes of you."/>
                <line pageid="310" textid="835" comment="Enemies will be present during your journey."/>
              </play_text>
            </do_all>
          </action>
          <cues>
            <cue name="L2M009A_Task" delay="1s">
              <condition>
                <check_all>
                  <cue_is_complete cue="L2M009A_Intro"/>
                </check_all>
              </condition>
              <timing>
                <time exact="1s"/>
              </timing>
              <action>
                <do_all>
                  <set_objective cue="L2M009A_Task" title="{1900,5201}" noabort="1">
                    <mission level="average"/>
                    <destroy object="{group.nearest@L2M009A.EnemyGroup}"/>
                  </set_objective>
                </do_all>
              </action>
              <cues>
                <cue name="L2M009A_Objective">
                  <condition>
                    <check_any>
                      <any_object_destroyed group="L2M009A.EnemyGroup"/>
                      <any_object_destroyed_by_player group="L2M009A.EnemyGroup"/>
                    </check_any>
                  </condition>
                  <timing>
                    <time exact="1s"/>
                  </timing>
                  <action>
                    <do_all>
                      <do_choose>
                        <do_when value="{group.object.count@L2M009A.EnemyGroup}" min="1">
                          <remove_objective cue="L2M009A_Task"/>
                          <reset_cue cue="L2M009A_Task"/>
                        </do_when>
                        <do_otherwise>
                          <remove_objective cue="L2M009A_Task" status="complete"/>
                        </do_otherwise>
                      </do_choose>
                    </do_all>
                  </action>
                </cue>
                <cue name="L2M009A_End" delay="2s">
                  <condition>
                    <check_all>
                      <cue_is_complete cue="L2M009A_Intro"/>
                      <any_object_exists group="L2M009A.EnemyGroup" negate="1"/>
                    </check_all>
                  </condition>
                  <action>
                    <do_all>
                      <do_all>
                        <play_text actor="L2M009A.FightInstructor" priority="99">
                          <line pageid="310" textid="841" comment="You have performed an excellent job."/>
                          <line pageid="310" textid="851" comment="There is no more time. That's it."/>
                        </play_text>
                      </do_all>
                    </do_all>
                  </action>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
  </cues>
  <signature>/hPIiotNE9EK/s0Lj/eTmrf7MIfBjynZR0MCKn9v4kOgqplIUuKBGHkfYy30tzVsZBFLayIFAM6Lm1iG+qgKDr5a6nYn80u6ddGZRR+Ciy3spi8oMJCaq3uE/U6LqZchdoDb1zEtHBbDTWdy0MFKOciGDag7NFTzm2sUFykrn73dH4z8nUQOepFnkivI/vSGT6XEqg+llD3vqfnSOe7OkskLrTQMxgyYKZwFNPUi5xC4u9qyKaYeSSn4/EAwnT4SBmaNCwEQJLgzrPc/RDv2EabZH50yW87772UGB2scVV5YFvGfXW+xGyPLYNysnlT0ejyNSgj3/1P3RS8k1/YlLQ==</signature>
</director>